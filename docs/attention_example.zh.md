# 位置编码和默认注意力示例

本文简要说明 `attention_demo.py` 中的正弦位置编码，并展示在嵌入维度为 2 时，句子 **"I love machine learning"** 的默认注意力矩阵。

## 正弦位置编码

对序列长度 `L`、维度 `d`，编码矩阵 `PE[L, d]` 的含义如下：

- **行** 对应 token 的位置（从 0 开始）。
- **列** 依次使用正弦与余弦函数。

第 `pos` 行第 `2i` 列的值为 `sin(pos / 10000^{2i/d})`，第 `2i+1` 列的值为 `cos(pos / 10000^{2i/d})`。

在默认设置（`L = 4`，`d = 2`）下，编码为：

| 位置 | dim0 (sin) | dim1 (cos) |
| --- | --- | --- |
| 0 | 0.00 | 1.00 |
| 1 | 0.84 | 0.54 |
| 2 | 0.91 | -0.42 |
| 3 | 0.14 | -0.99 |

## 默认注意力权重

使用随机种子 `0` 初始化向量，投影矩阵为单位阵时，句子 **"I love machine learning"** 的注意力矩阵为：

| query\key | I | love | machine | learning |
| --- | --- | --- | --- | --- |
| **I** | 0.25 | 0.26 | 0.23 | 0.26 |
| **love** | 0.20 | 0.26 | 0.16 | 0.38 |
| **machine** | 0.24 | 0.21 | 0.35 | 0.20 |
| **learning** | 0.10 | 0.19 | 0.08 | 0.63 |

每行权重之和均为 1。例如 `love → learning` 的权重约为 0.38，表示 **"love"** 的输出约 38 % 来源于 **"learning"**；最后一行可以看到 **"learning"** 主要关注自身（≈0.63）。
